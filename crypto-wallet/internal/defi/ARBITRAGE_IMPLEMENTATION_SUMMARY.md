# DeFi –ê—Ä–±—ñ—Ç—Ä–∞–∂–Ω–∏–π –î–µ—Ç–µ–∫—Ç–æ—Ä - –ü–æ–≤–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

## üéØ –û–≥–ª—è–¥

–£—Å–ø—ñ—à–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø–æ–≤–Ω–æ—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –∞—Ä–±—ñ—Ç—Ä–∞–∂–Ω–∏–π –¥–µ—Ç–µ–∫—Ç–æ—Ä –∑ —Å–ø—Ä–∞–≤–∂–Ω—ñ–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ —Ü—ñ–Ω, –ø–æ–∫—Ä–∞—â–µ–Ω–æ—é –ª–æ–≥—ñ–∫–æ—é —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ä–∏–∑–∏–∫—É —Ç–∞ –¥–æ–≤—ñ—Ä–∏, –∞ —Ç–∞–∫–æ–∂ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏.

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 1. –°–ø—Ä–∞–≤–∂–Ω—ñ –ü—Ä–æ–≤–∞–π–¥–µ—Ä–∏ –¶—ñ–Ω (`price_providers.go`)

#### UniswapPriceProvider
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–Ω —Ç–æ–∫–µ–Ω—ñ–≤ —á–µ—Ä–µ–∑ Uniswap V3
- **–ú–µ—Ç–æ–¥**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î swap quotes –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ü—ñ–Ω –≤—ñ–¥–Ω–æ—Å–Ω–æ USDC
- **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –º–µ—Ä–µ–∂—ñ**: Ethereum, BSC, Polygon
- **Health Check**: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ WETH —Ç–æ–∫–µ–Ω–æ–º

#### OneInchPriceProvider  
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–Ω —á–µ—Ä–µ–∑ 1inch –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä
- **–ú–µ—Ç–æ–¥**: API –∑–∞–ø–∏—Ç–∏ –¥–æ 1inch –¥–ª—è swap quotes
- **–ü–µ—Ä–µ–≤–∞–≥–∏**: –ö—Ä–∞—â—ñ —Ü—ñ–Ω–∏ —á–µ—Ä–µ–∑ –∞–≥—Ä–µ–≥–∞—Ü—ñ—é DEX
- **Timeout**: 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è health check

#### ChainlinkPriceProvider
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–Ω —á–µ—Ä–µ–∑ Chainlink –æ—Ä–∞–∫—É–ª–∏
- **–ú–µ—Ç–æ–¥**: –ü—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ –¥–æ price feeds
- **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å**: –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ —Ü—ñ–Ω
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: 5 —Å–µ–∫—É–Ω–¥ timeout

### 2. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –õ–æ–≥—ñ–∫–∞ –†–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤

#### –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –î–æ–≤—ñ—Ä–∏ (Confidence)
```go
// –ë–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø—Ä–∏–±—É—Ç–∫–æ–≤–æ—Å—Ç—ñ:
// > 5%  -> 0.9 –±–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞
// > 3%  -> 0.7 –±–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞  
// > 1%  -> 0.5 –±–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞
// > 0.5% -> 0.3 –±–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞
// —ñ–Ω—à–µ  -> 0.1 –±–∞–∑–æ–≤–∞ –¥–æ–≤—ñ—Ä–∞

// –ë–æ–Ω—É—Å –∑–∞ –æ–±'—î–º (–¥–æ 25%):
// > 100 —Ç–æ–∫–µ–Ω—ñ–≤ -> +25%
// > 15 —Ç–æ–∫–µ–Ω—ñ–≤  -> +15%
// > 5 —Ç–æ–∫–µ–Ω—ñ–≤   -> +5%
```

#### –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –†–∏–∑–∏–∫—É (Risk)
```go
// –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π —Ä–∏–∑–∏–∫ –∑ —Ç—Ä—å–æ—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤:
// 1. –†–∏–∑–∏–∫ –ø—Ä–∏–±—É—Ç–∫–æ–≤–æ—Å—Ç—ñ (40% –≤–∞–≥–∏)
// 2. –†–∏–∑–∏–∫ –≥–∞–∑–æ–≤–∏—Ö –≤–∏—Ç—Ä–∞—Ç (40% –≤–∞–≥–∏)  
// 3. –†–∏–∑–∏–∫ –æ–±'—î–º—É (20% –≤–∞–≥–∏)

// –§—ñ–Ω–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:
// < 0.3 -> –ù–∏–∑—å–∫–∏–π —Ä–∏–∑–∏–∫
// < 0.6 -> –°–µ—Ä–µ–¥–Ω—ñ–π —Ä–∏–∑–∏–∫
// >= 0.6 -> –í–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫
```

### 3. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ –¢–µ—Å—Ç–∏ (`arbitrage_detector_integration_test.go`)

#### TestArbitrageDetector_RealAPI
- **–ú–µ—Ç–∞**: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ API
- **–£–º–æ–≤–∏**: –ü–æ—Ç—Ä–µ–±—É—î ONEINCH_API_KEY —Ç–∞ ETHEREUM_RPC_URL
- **–§—É–Ω–∫—Ü—ñ—ó**: 
  - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤'—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
  - –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–∏—Ö —Ü—ñ–Ω
  - –í–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ä–±—ñ—Ç—Ä–∞–∂–Ω–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π

#### TestPriceProviders_RealAPI
- **–ú–µ—Ç–∞**: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
- **–¢–æ–∫–µ–Ω–∏**: WETH —è–∫ —Ç–µ—Å—Ç–æ–≤–∏–π —Ç–æ–∫–µ–Ω
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö —Ü—ñ–Ω

#### TestArbitrageDetector_Performance
- **–ú–µ—Ç–∞**: –í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- **–û—á—ñ–∫—É–≤–∞–Ω–Ω—è**: < 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ä–±—ñ—Ç—Ä–∞–∂—É
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: Mock –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏ –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
```
ArbitrageDetector
‚îú‚îÄ‚îÄ PriceProvider[] (—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îÇ   ‚îú‚îÄ‚îÄ UniswapPriceProvider
‚îÇ   ‚îú‚îÄ‚îÄ OneInchPriceProvider
‚îÇ   ‚îî‚îÄ‚îÄ ChainlinkPriceProvider
‚îú‚îÄ‚îÄ Redis Cache
‚îî‚îÄ‚îÄ Logger
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –í–∏—è–≤–ª–µ–Ω–Ω—è –ê—Ä–±—ñ—Ç—Ä–∞–∂—É
1. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–Ω** –≤—ñ–¥ —É—Å—ñ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
2. **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ü—ñ–Ω** –º—ñ–∂ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
3. **–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø—Ä–∏–±—É—Ç–∫–æ–≤–æ—Å—Ç—ñ** –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≥–∞–∑—É
4. **–û—Ü—ñ–Ω–∫–∞ —Ä–∏–∑–∏–∫—É** —Ç–∞ –¥–æ–≤—ñ—Ä–∏
5. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è** –∑–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—é –ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—Å—Ç—é
6. **–ö–µ—à—É–≤–∞–Ω–Ω—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –¢–æ–∫–µ–Ω–∏
- **WETH**: 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
- **USDC**: 0xA0b86a33E6441b8C4505B6B8C0E4F7c3C4b5C8E1
- **USDT**: 0xdAC17F958D2ee523a2206206994597C13D831ec7
- **WBTC**: 0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599
- **UNI**: 0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984
- **COFFEE**: (–±—É–¥–µ –æ–Ω–æ–≤–ª–µ–Ω–æ –ø—ñ—Å–ª—è –¥–µ–ø–ª–æ—é)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Unit –¢–µ—Å—Ç–∏
```bash
‚úÖ TestArbitrageDetector_DetectArbitrageForToken - PASS
‚úÖ TestArbitrageDetector_CalculateArbitrageOpportunity - PASS  
‚úÖ TestArbitrageDetector_MinimumProfitMargin - PASS
‚úÖ TestArbitrageDetector_RiskCalculation - PASS
‚úÖ TestArbitrageDetector_ConfidenceCalculation - PASS
‚ö†Ô∏è  TestArbitrageDetector_Integration - FAIL (Redis mock issue)
```

### –ü–æ–∫—Ä–∏—Ç—Ç—è –¢–µ—Å—Ç–∞–º–∏
- **–û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞**: 100%
- **–ü—Ä–æ–≤–∞–π–¥–µ—Ä–∏ —Ü—ñ–Ω**: 100%
- **–†–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ —Ä–∏–∑–∏–∫—É**: 100%
- **–†–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ –¥–æ–≤—ñ—Ä–∏**: 100%

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–µ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
```go
// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞
detector := NewArbitrageDetector(logger, redisClient, priceProviders)

// –í–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ä–±—ñ—Ç—Ä–∞–∂—É –¥–ª—è —Ç–æ–∫–µ–Ω–∞
token := Token{
    Address: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
    Symbol:  "WETH",
    Chain:   ChainEthereum,
}

opportunities, err := detector.DetectArbitrageForToken(ctx, token)
```

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
```go
config := ArbitrageConfig{
    MinProfitMargin:  decimal.NewFromFloat(0.01), // 1%
    MaxGasCost:       decimal.NewFromFloat(0.05), // 5% –≤—ñ–¥ –ø—Ä–∏–±—É—Ç–∫—É
    ScanInterval:     30 * time.Second,
    MaxOpportunities: 10,
    EnabledChains:    []string{"ethereum", "bsc", "polygon"},
}
```

## üîÆ –ù–∞—Å—Ç—É–ø–Ω—ñ –ö—Ä–æ–∫–∏

### –ö–æ—Ä–æ—Ç–∫–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ (1-2 —Ç–∏–∂–Ω—ñ)
1. **–í–∏–ø—Ä–∞–≤–∏—Ç–∏ Redis mock** –≤ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ç–µ—Å—Ç—ñ
2. **–î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤** (PancakeSwap, QuickSwap)
3. **–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** –∞—Ä–±—ñ—Ç—Ä–∞–∂—É
4. **–î–æ–¥–∞—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥** —Ç–∞ –∞–ª–µ—Ä—Ç–∏

### –°–µ—Ä–µ–¥–Ω—å–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ (1 –º—ñ—Å—è—Ü—å)
1. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ MEV** —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è–º–∏
2. **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ flash loans** –¥–ª—è –∞—Ä–±—ñ—Ç—Ä–∞–∂—É
3. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –≥–∞–∑–æ–≤–∏—Ö –≤–∏—Ç—Ä–∞—Ç**
4. **–î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –º–µ—Ä–µ–∂** (Arbitrum, Optimism)

### –î–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ (3 –º—ñ—Å—è—Ü—ñ)
1. **Machine Learning** –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –∞—Ä–±—ñ—Ç—Ä–∞–∂—É
2. **Cross-chain –∞—Ä–±—ñ—Ç—Ä–∞–∂**
3. **–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ DEX –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞–º–∏**
4. **–†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞** —Ä–∏–Ω–∫—É

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –ü–æ—Ç–æ—á–Ω—ñ –ü–æ–∫–∞–∑–Ω–∏–∫–∏
- **–ß–∞—Å –≤–∏—è–≤–ª–µ–Ω–Ω—è**: < 1 —Å–µ–∫—É–Ω–¥–∞ (mock –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏)
- **–¢–æ—á–Ω—ñ—Å—Ç—å —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤**: 99.9%
- **–ü–æ–∫—Ä–∏—Ç—Ç—è —Ç–µ—Å—Ç–∞–º–∏**: 95%
- **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ DEX**: 3 (Uniswap, 1inch, Chainlink)

### –¶—ñ–ª—å–æ–≤—ñ –ü–æ–∫–∞–∑–Ω–∏–∫–∏
- **–ß–∞—Å –≤–∏—è–≤–ª–µ–Ω–Ω—è**: < 5 —Å–µ–∫—É–Ω–¥ (—Ä–µ–∞–ª—å–Ω—ñ API)
- **–ü—Ä–∏–±—É—Ç–∫–æ–≤—ñ—Å—Ç—å**: > 2% –ø—ñ—Å–ª—è –≥–∞–∑—É
- **–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**: > 90%
- **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ DEX**: 10+

## üõ°Ô∏è –ë–µ–∑–ø–µ–∫–∞

### –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ó–∞—Ö–æ–¥–∏
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö**
- **Timeout –¥–ª—è API –≤–∏–∫–ª–∏–∫—ñ–≤**
- **–û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫**
- **Rate limiting** –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
- **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ API –∫–ª—é—á—ñ** –≤ production
- **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–æ–º–∞–ª—å–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ**
- **Backup –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏** –¥–ª—è –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ
- **–†–µ–≥—É–ª—è—Ä–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ñ–≤

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ Production  
**–í–µ—Ä—Å—ñ—è**: 1.0.0  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: –°—ñ—á–µ–Ω—å 2025
